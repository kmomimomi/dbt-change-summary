# モチベーション

dbtプロジェクトおよびAirflow DAGを管理しているリポジトリに対して、リッチにCIをかけ、またレビューが簡単にできるようにしたい。

## 想定する開発フロー

* 開発者がfeatureブランチでdbtやDAGを編集し、mainブランチへPRを作成する。
* PR作成時点でCI/CDが起動する。
  * 自動テストが走る（DAGのpytestなど）
  * プロジェクトに対しての静的チェックが走る
  * 変更内容をまとめたコメントがPRに自動で追加される
* レビュアーはCIの結果やコメントを元にしてレビューを行う。
* レビュー後、マージされたタイミングでCI/CDが起動する。
  * プロジェクト中のモデル一覧ファイルがExcel化され、Github の ReleaseにAssetとして吐き出される。

# このリポジトリでやりたいこと

GithubのカスタムActionを作成したいです。
主な機能は以下の通り。
* dbtプロジェクトの変更内容をまとめたコメントをPRへ追加する。
  * プロジェクトレベルの設定変更（例: varsの追加・削除、database/schemaの変更）
  * ノードレベルの設定変更（例: モデルやseedの追加・削除、configやmeta情報の変更）
  * カラムレベルの変更（例: カラムの追加・削除、型の変更）
  * 変更内容が多い場合は、種類ごとに件数をまとめたサマリーを生成し、Markdown形式でPRに投稿する。
* マージされたタイミングで、Releaseにモデル一覧のExcelを吐き出す。
  * モデル名
  * エイリアス名（実際にデータベースに実体化される際のテーブル・ビュー名）
  * description
  * materialize（ビュー、テーブル、インクリメンタルなど）
  * tag（設定されていれば。複数ある場合は1列にまとめる）
  * meta（設定されていれば。複数ある場合は複数カラムにFlat化）
  * レイヤー（ディレクトリ相対パスで表現）

また、それを提供するための一連のテストや自動化も含みます。
